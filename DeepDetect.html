<!DOCTYPE html>
<html lang='en-US' xml:lang='en-US'>
<head><title>Additional Information of DeepDetect</title>
<!-- <meta charset='iso-8859-1' /> -->

<meta charset="UTF-8">

<meta content='TeX4ht (http://www.tug.org/tex4ht/)' name='generator' />
<meta content='width=device-width,initial-scale=1' name='viewport' />
<link href='DeepDetect.css' rel='stylesheet' type='text/css' />
<meta content='DeepDetect.tex' name='src' />
</head><body>
  <div class="contents">
   <div class='maketitle'>





<h2 class='titleHead'>Additional Information of DeepDetect</h2>
 <div class='author'><span
 class="cmr-12x-x-120">Saurabh Kumar</span></div><br />
<div class='date'><span class='cmr-12x-x-120'>November 12, 2021</span></div>
   </div>
   <h3 class='sectionHead'><span class='titlemark'>1   </span> <a id='x1-10001'></a>Dataset Used</h3>
<!-- l. 32 --><p class='noindent'>This work uses multiple dataset (see Table <a href='#x1-10011'>1<!-- tex4ht:ref: tab:malben  --></a>) for the evaluation of DeepDetect. Details of these
dataset are as follows: </p><div class='table'>


<!-- l. 33 --><p class='indent'>   <a id='x1-10011'></a></p><figure class='float'>


<figcaption class='caption'><span class='id'>Table 1:</span><span class='content'>Number of malware and benign samples collected from different sources, where double hyphen
(--) denotes that samples are not available.</span></figcaption><!-- tex4ht:label?: x1-10011  -->
<div class='tabular'> <table cellpadding='0' cellspacing='0' class='tabular' id='TBL-2'><colgroup id='TBL-2-1g'><col id='TBL-2-1' /></colgroup><colgroup id='TBL-2-2g'><col id='TBL-2-2' /></colgroup><colgroup id='TBL-2-3g'><col id='TBL-2-3' /></colgroup><colgroup id='TBL-2-4g'><col id='TBL-2-4' /></colgroup><colgroup id='TBL-2-5g'><col id='TBL-2-5' /></colgroup><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-2-1-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-1-1'> <span class='cmbx-12'>Data/Source </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-1-2'>   <span class='cmbx-12'>Year    </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-1-3'> <span class='cmbx-12'>Malware </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-1-4'> <span class='cmbx-12'>Benign </span></td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-1-5'> <span class='cmbx-12'>Description and Usage                                                       </span></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-2-2-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-2-1'>    AMD<span class='cite'>[<a href='#Xwei2017deep'>5</a>]</span>      </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-2-2'>  till 2016   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-2-3'>  24<span class='cmmi-12'>, </span>553    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-2-4'>   --      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-2-5'> 80% randomly selected samples are used for training final model,            </td>
</tr><tr class='cline'><td></td><td><hr /></td><td><hr /></td><td><hr /></td><td></td></tr><tr id='TBL-2-4-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-4-1'>  VirusShare<span class='cite'>[<a href='#XVirusShare:2018'>6</a>]</span>   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-4-2'> Apr. 2018  </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-4-3'>  20<span class='cmmi-12'>, </span>979    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-4-4'>    --      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-4-5'> feature engineering and as known samples and remaining 20% is unseen   </td>
</tr><tr class='cline'><td></td><td><hr /></td><td><hr /></td><td><hr /></td><td></td></tr><tr id='TBL-2-6-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-6-1'>   Play Store     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-6-2'> Apr. 2018  </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-6-3'>     --       </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-6-4'>  56<span class='cmmi-12'>, </span>346  </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-6-5'> samples which is also used in feature comparison.                                </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-2-7-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-7-1'> <div class='multirow'><!--  rows=6  -->
Androzoo-2019</div>  </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-7-2'>   <div class='multirow'><!--  rows=6  -->
2019</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-7-3'>   <div class='multirow'><!--  rows=6  -->
5380</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-7-4'>  <div class='multirow'><!--  rows=6  -->
5380</div>    </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-7-5'> Downloaded from Androzoo project for the year 2019 and used as new    </td>
</tr><tr id='TBL-2-8-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-8-1'>               </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-8-2'>          </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-8-3'>          </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-8-4'>         </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-8-5'> App for the evaluation.                                                                  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-2-9-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-9-1'>   <div class='multirow'><!--  rows=6  -->
Obfuscated</div>    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-9-2'>   <div class='multirow'><!--  rows=6  -->
2019</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-9-3'>   <div class='multirow'><!--  rows=6  -->
4993</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-9-4'>    <div class='multirow'><!--  rows=6  -->
--</div>      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-9-5'> Obtained by obfuscating malware of Androzoo-2019 using Obfusapktool,  </td>
</tr><tr id='TBL-2-10-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-10-1'>               </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-10-2'>          </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-10-3'>          </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-10-4'>         </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-10-5'> which is categorized in six category.                                                  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-2-11-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-11-1'>  <div class='multirow'><!--  rows=6  -->
Space &amp; time</div>   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-11-2'>   2016     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-11-3'>   5110     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-11-4'>  45988   </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-11-5'> We have downloaded 87,634 unique samples from Androzoo project        </td>
</tr><tr class='cline'><td></td><td><hr /></td><td><hr /></td><td><hr /></td><td></td></tr><tr id='TBL-2-13-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-13-1'>               </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-13-2'>   2017     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-13-3'>   1424     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-13-4'>  12624   </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-13-5'> spaning for 4 years. We use samples from 2016 for training and rest for    </td>
</tr><tr class='cline'><td></td><td><hr /></td><td><hr /></td><td><hr /></td><td></td></tr><tr id='TBL-2-15-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-15-1'>               </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-15-2'>   2018     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-15-3'>   1182     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-15-4'>  10444   </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-15-5'> the evaluation of DeepDetect quarter wise by removing potential biases   </td>
</tr><tr class='cline'><td></td><td><hr /></td><td><hr /></td><td><hr /></td><td></td></tr><tr id='TBL-2-17-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-17-1'>               </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-17-2'>   2019     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-17-3'>   1105     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-2-17-4'>  9757    </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-2-17-5'> by including only <span class='cmsy-10x-x-120'>~</span>10% malware samples for each quarter of every year.  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table></div>


   </figure>
   </div>
<!-- l. 63 --><p class='indent'>   Firstly, We use a class balanced dataset that consists of 96,748 Apps. The dataset has 40,402
unique malware distributed across more than 70 different classes of malware. These distributed set of
malware helps the classifier to learn more about different variants to identify unseen malicious Apps.
In the dataset, the malware samples are collected from AMD<span class='cite'>[<a href='#Xwei2017deep'>5</a>]</span> and VirusShare<span class='cite'>[<a href='#XVirusShare:2018'>6</a>]</span>. For
benign Apps, we have crawled through the Play Store and gathered 65,806 samples. These
samples were passed to VirusTotal<span class='cite'>[<a href='#XVirusTotal:2019'>7</a>]</span> to make sure they are benign. The Apps that are
identified as malicious by even one antivirus engine on VirusTotal are discarded to create the
benign dataset resulting in 56,346 benign samples. AMD dataset contains malware collected
between the years 2012 to 2016, whereas the malware from VirusShare and benign Apps from
Play Store were collected in April 2018. This dataset is widely used in our work such as
training the model, feature engineering and testing. We randomly separated the 80% dataset
which we use for training a model and feature enginnering part. These 80% samples are
also used for evaluating a model in the case of known samples. The reaming 20% samples
(Evaluation set) are being used to evaluate the efficacy of different features and our model
against the unseen samples. An unseen App referes to the sample that is not the part of the
training samples but may belongs to the same period as of training sample or even prior to
that
</p><!-- l. 65 --><p class='indent'>   Secondly, we have collected 10760 unique samples from AndroZoo project (referred to as
Androzoo-2019) that contains 5380 malware samples and rest are benign which belongs to the year
2019 only. We use these samples to evaluate the efficacy of DeepDetect against the new sample. New
samples are those samples whose Dex date period is always after the Dex date period of training
samples.
</p><!-- l. 67 --><p class='indent'>   Thirdly, we have collected five samples of Pegasus malware from the CloudSek organization to
check the ability of DeepDetect to identify the Pegasus malware. Only these five unique samples are
available, hence we have used the same for evaluation.
</p><!-- l. 69 --><p class='indent'>   Additionally, we have created a dataset of obfuscated malware samples by obfuscating the
malware sample of Androzoo-2019. We use Obfusapk tool to create this dataset and successfully
generated 4993 uniques obfuscated samples which false in six category.
</p><!-- l. 71 --><p class='indent'>   Lastly, we have also collected 87,634 unique samples spanning for four years (2016 t0 2019) In this
dataset, we have collected <span class='cmsy-10x-x-120'>~</span>10% malware sample for each quarter of every year and remaining 90% as
benign sample. These samples are being used to evaluate DeepDetect by removing potential biases
across time and space. From these samples, we use samples from 2016 to training a model and rest for
the quarter wise evaluation.
</p>
   <h3 class='sectionHead'><span class='titlemark'>2   </span> <a id='x1-20002'></a>Features Used in DeepDetect</h3>
<!-- l. 76 --><p class='noindent'>The feature used in DeepDetect are as follows:
</p><!-- l. 79 --><p class='noindent'><span class='cmbxti-10x-x-120'>(i) </span><span class='cmbx-12'>Numeric Features: </span>List of numeric feature used are as follows:


</p>
   <div class='verbatim' id='verbatim-1'>
Activities<br />
Services<br />
Brodcast Receivers<br />
Content Providers<br />
Custom Permissions.
</div>
<!-- l. 87 --><p class='nopar'>
</p><!-- l. 89 --><p class='noindent'><span class='cmbxti-10x-x-120'>(ii) </span><span class='cmbx-12'>Requested Permissions: </span>The list of requested permission used are as follows:


</p>
   <div class='verbatim' id='verbatim-2'>
android.permission.RECEIVE_BOOT_COMPLETED <br />
android.permission.ACCESS_NETWORK_STATE<br />
android.permission.RECEIVE_SMS<br />
android.permission.VIBRATE<br />
android.permission.ACCESS_COARSE_LOCATION<br />
android.permission.INSTALL_PACKAGES<br />
android.permission.READ_SMS<br />
android.permission.PROCESS_OUTGOING_CALLS<br />
android.permission.READ_PHONE_STATE<br />
android.permission.WRITE_EXTERNAL_STORAGE<br />
android.permission.WAKE_LOCK<br />
android.permission.SEND_SMS<br />
android.permission.INTERNET<br />
android.permission.GET_ACCOUNTS<br />
android.permission.DISABLE_KEYGUARD<br />
android.permission.CHANGE_WIFI_STATE<br />
android.permission.ACCESS_WIFI_STATE<br />
android.permission.READ_LOGS<br />
android.permission.CALL_PHONE<br />
android.permission.READ_CONTACTS<br />
android.permission.GET_TASKS<br />
android.permission.WRITE_SMS<br />
android.permission.SET_WALLPAPER<br />
android.permission.ACCESS_GPS<br />
android.permission.WRITE_SETTINGS<br />
android.permission.READ_EXTERNAL_STORAGE<br />
android.permission.SYSTEM_ALERT_WINDOW<br />
android.permission.RESTART_PACKAGES<br />
android.permission.MOUNT_UNMOUNT_FILESYSTEMS<br />
android.permission.CHANGE_NETWORK_STATE<br />
android.permission.WRITE_CONTACTS<br />
android.permission.CAMERA<br />
android.permission.KILL_BACKGROUND_PROCESSES<br />
android.permission.ACCESS_LOCATION_EXTRA_COMMANDS<br />
android.permission.BLUETOOTH_ADMIN<br />
android.permission.USE_CREDENTIALS<br />
android.permission.RECORD_AUDIO<br />
android.permission.MODIFY_AUDIO_SETTINGS<br />
android.permission.BROADCAST_STICKY<br />
android.permission.CHANGE_CONFIGURATION
</div>
<!-- l. 132 --><p class='nopar'>
</p><!-- l. 134 --><p class='noindent'><span class='cmbxti-10x-x-120'>(iii) </span><span class='cmbx-12'>2-Gram Opcode Sequence: </span>The 2-Gram opcode sequence used in DeepDetect
are shown bellow. To know about the Reduce instruction set symbols, plese see Table
<a href='#x1-20012'>2<!-- tex4ht:ref: tab:redIns  --></a>.


</p>
   <div class='verbatim' id='verbatim-3'>
DX,XR,VD,PG,IL,<br />
LL,SC,SR,BV,TM,<br />
AA,FM,OM,TR,XP,<br />
GM,XI,PA,AT,OL,<br />
DM,DP,FP,SX,OP,<br />
FT,LV,MM,TP,SB
</div>
<!-- l. 143 --><p class='nopar'>
</p>
   <div class='table'>


<!-- l. 145 --><p class='indent'>   <a id='x1-20012'></a></p><figure class='float'>


<figcaption class='caption'><span class='id'>Table 2:</span><span class='content'>Reduced instruction set with description.</span></figcaption><!-- tex4ht:label?: x1-20012  -->
<div class='tabular'> <table cellpadding='0' cellspacing='0' class='tabular' id='TBL-3'><colgroup id='TBL-3-1g'><col id='TBL-3-1' /></colgroup><colgroup id='TBL-3-2g'><col id='TBL-3-2' /></colgroup><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-1-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-1-1'> <span class='cmbx-12'>Symbol </span></td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-1-2'> <span class='cmbx-12'>Description                                                    </span></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-2-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-2-1'>    A       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-2-2'> Arithmetic operation instructions                                 </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-3-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-3-1'>    B       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-3-2'> Branch instruction (Conditional jump like if-eq).             </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-4-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-4-1'>    C       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-4-2'> Comparision instruction like cmpl-float                          </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-5-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-5-1'>    D      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-5-2'> Data Definition instructions like const/4                        </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-6-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-6-1'>    <div class='multirow'><!--  rows=6  -->
F</div>       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-6-2'> Type conversion instructions (int-to-long, int-to-float)      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-7-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-7-1'>    G      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-7-2'> Get instructions (aget, aget-wide)                                 </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-8-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-8-1'>    <div class='multirow'><!--  rows=6  -->
I</div>       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-8-2'> Method call instructions (invoke-direct, invoke-virtual ...)  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-9-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-9-1'>    J       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-9-2'> Jump instructions (Unconditional) like goto.                  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-10-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-10-1'>    <div class='multirow'><!--  rows=6  -->
L</div>       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-10-2'> Lock instruction, the use to acquire/release a lock           </td>
</tr><tr id='TBL-3-11-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-11-1'>          </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-11-2'> (monitor-enter and monitor-exit)                                  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-12-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-12-1'>    <div class='multirow'><!--  rows=6  -->
M</div>      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-12-2'> Data manipulation instruction like move and its variants  </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-13-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-13-1'>    O      </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-13-2'> Exception instruction (through)                                   </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-14-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-14-1'>    P       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-14-2'> Put instructions (aput, aput-wide)                                </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-15-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-15-1'>    R       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-15-2'> Return instruction like return-void                               </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-16-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-16-1'>    S       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-16-2'> Bit-wise operation instructions (and-int, shl-int)              </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-17-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-17-1'>    T       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-17-2'> Type judgement like check-cast                                    </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-18-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-18-1'>    V       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-18-2'> Array operation instructions like array-length                 </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr><tr id='TBL-3-19-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-3-19-1'>    X       </td><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-3-19-2'> switch case instructions                                              </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td></tr></table></div>


   </figure>
   </div>
   <h3 class='sectionHead'><span class='titlemark'>3   </span> <a id='x1-30003'></a>Additional Experiments and Results</h3>
<!-- l. 181 --><p class='noindent'>This section contains additional results and experiments that have carried out for the evaluation of
DeepDetect and does not showcase in original paper due to the page limit.
</p><!-- l. 183 --><p class='noindent'>
</p>
   <h4 class='subsectionHead'><span class='titlemark'>3.1   </span> <a id='x1-40003.1'></a>Performance Comparison of Features</h4>
<!-- l. 184 --><p class='noindent'>In the paper, we have shown only the ROC curve along with the AUC value. The evaluation results
against other metrices is shown in Table <a href='#x1-40013'>3<!-- tex4ht:ref: tab:featComp  --></a>. </p><div class='table'>


<!-- l. 185 --><p class='indent'>   <a id='x1-40013'></a></p><figure class='float'>


<figcaption class='caption'><span class='id'>Table 3:</span><span class='content'>Evaluation  of  various  feature  extracted  from  Dex  file.  UP:  Used  Permission,  SA:
Sensitive APIs, RA: Restricted APIs and USR: Combined features (UP, SA and RA).</span></figcaption><!-- tex4ht:label?: x1-40013  -->
<div class='tabular'> <table cellpadding='0' cellspacing='0' class='tabular' id='TBL-4'><colgroup id='TBL-4-1g'><col id='TBL-4-1' /></colgroup><colgroup id='TBL-4-2g'><col id='TBL-4-2' /></colgroup><colgroup id='TBL-4-3g'><col id='TBL-4-3' /></colgroup><colgroup id='TBL-4-4g'><col id='TBL-4-4' /></colgroup><colgroup id='TBL-4-5g'><col id='TBL-4-5' /></colgroup><colgroup id='TBL-4-6g'><col id='TBL-4-6' /></colgroup><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-1-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-1-1'> <span class='cmbx-12'>Features </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-1-2'> <span class='cmbx-12'>#Features </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-1-3'> <span class='cmbx-12'>Pre (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-1-4'> <span class='cmbx-12'>Rec (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-1-5'> <span class='cmbx-12'>F1 (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-1-6'> <span class='cmbx-12'>FPR (%) </span></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-2-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-2-1'> <div class='multirow'><!--  rows=6  -->
1-Gram</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-2-2'>     18        </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-2-3'>   94.71    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-2-4'>   91.74    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-2-5'>  93.42   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-2-6'>    3.33      </td></tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-3-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-3-1'> <div class='multirow'><!--  rows=6  -->
2-Gram</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-3-2'>     30        </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-3-3'>   96.26    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-3-4'>   94.25    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-3-5'>  95.39   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-3-6'>    2.40      </td></tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-4-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-4-1'> <div class='multirow'><!--  rows=6  -->
3-Gram</div>     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-4-2'>     44        </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-4-3'>   97.44    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-4-4'>   95.47    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-4-5'>  96.75   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-4-6'>    1.35      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-5-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-5-1'> <div class='multirow'><!--  rows=6  -->
UP</div>           </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-5-2'>     59        </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-5-3'>   92.35    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-5-4'>   86.59    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-5-5'>  90.05   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-5-6'>    4.10      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-6-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-6-1'> <div class='multirow'><!--  rows=6  -->
SA</div>           </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-6-2'>     42        </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-6-3'>   86.13    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-6-4'>   83.60    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-6-5'>  83.79   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-6-6'>   11.44     </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-7-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-7-1'> <div class='multirow'><!--  rows=6  -->
RA</div>           </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-7-2'>    959       </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-7-3'>   84.23    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-7-4'>   88.76    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-7-5'>  82.72   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-7-6'>   18.49     </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-4-8-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-4-8-1'> <div class='multirow'><!--  rows=6  -->
USR</div>         </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-8-2'>    1060      </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-8-3'>   96.48    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-8-4'>   92.10    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-8-5'>  95.13   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-4-8-6'>    1.10      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table></div>


   </figure>
   </div>
   <h4 class='subsectionHead'><span class='titlemark'>3.2   </span> <a id='x1-50003.2'></a>Performance Against Known, Unseen, and New Samples</h4>
<!-- l. 208 --><p class='noindent'>Figure <a href='#x1-50011'>1<!-- tex4ht:ref: fig:ROCKUNAnalysis  --></a> shows the performance results against the ROC curve and AUC value which are not
described in the paper due to page limitations. </p><figure class='figure'>



<a id='x1-50011'></a>


<!-- l. 211 --><p class='noindent'> <img width='600' alt='PIC' src='images/ROC-curve-Final-Model-.png' />
</p>
<figcaption class='caption'><span class='id'>Figure 1:</span><span class='content'>AUC-ROC curve for the final model evaluated against the known, unseen and new
samples.</span></figcaption><!-- tex4ht:label?: x1-50011  -->


   </figure>
   <h4 class='subsectionHead'><span class='titlemark'>3.3   </span> <a id='x1-60003.3'></a>Performance of Restricted APIs and 2-Gram Opcode Sequence with Multiple
Classifier</h4>
<!-- l. 218 --><p class='noindent'>In this section, we compare the performance of 2-Gram opcode sequence (2-Opc) based
model with restricted APIs. Restricted APIs (or API call) are widely used in both type of
malware detection system—<span class='cmti-12'>(i) </span>on-device (Drebin <span class='cite'>[<a href='#XArp14drebin:effective'>1</a>]</span>, IntelliAV <span class='cite'>[<a href='#XintelliAV'>2</a>]</span>, and <span class='cmti-12'>(ii) </span>on a server in
off-line fashion (DroidSeive <span class='cite'>[<a href='#X10.1145/3029806.3029825'>3</a>]</span>, Garcia et al. <span class='cite'>[<a href='#X10.1145/3162625'>4</a>]</span>). Restricted APIs are those API which
requires some permission but same is not declared in the manifest file. Therefore, we can
say that restricted APIs generally showcase the malicious intents of an App. The main
reason for showcasing the performance of 2-Gram opcode sequence against the restricted
APIs.
</p><!-- l. 220 --><p class='indent'>   In this evaluation, we have used six classifiers to measure the performance of individual feature
sets. Classifier training and testing are performed on the training and evaluation set, respectively. The
six classifiers that we have used are --<span class='cmti-12'>(i) </span>Random Forest, <span class='cmti-12'>(ii) </span>Extra Tree, <span class='cmti-12'>(iii) </span>Decision Tree, <span class='cmti-12'>(iv)</span>
Logistic Regression, <span class='cmti-12'>(v) </span>Neural Network and <span class='cmti-12'>(vi) </span>Nearest Neighbour. The evaluation results (see
Table <a href='#x1-60014'>4<!-- tex4ht:ref: tab:difFeatClas  --></a>) show that the 2-Gram opcode sequence feature set outperforms the restricted
APIs in all tree based classifiers and Neural Network classifier with the malware detection
rate of more than 85%. However, the detection rate of 2-Gram opcode sequence is lower
then Restricted APIs for Logistic regression and Nearest Neighbour. If we observes the
false positive rate of these two classifier, it is relatively very high for restricted APIs in
compare to 2-Gram opcode sequence. The possible reason is that the API calls are the
most susceptible to obfuscation attacks to bypass the static analysis process. Also, in
the newer version of Android OS, some API may go outdated or suppressed, which will
not be present in the future/unknown Apps. Hence, a model’s performance may degrade
that utilizes the API call information to detect malware. That is the main reason behind
using opcode information in designing the on-device malware detector instead of API call
information.
</p>
   <div class='table'>


<!-- l. 224 --><p class='indent'>   <a id='x1-60014'></a></p><figure class='float'>


<figcaption class='caption'><span class='id'>Table 4:</span><span class='content'>Comparision of 2-Gram opcode sequence (2-Opc) with restricted APIs</span></figcaption><!-- tex4ht:label?: x1-60014  -->
<div class='tabular'> <table cellpadding='0' cellspacing='0' class='tabular' id='TBL-5'><colgroup id='TBL-5-1g'><col id='TBL-5-1' /></colgroup><colgroup id='TBL-5-2g'><col id='TBL-5-2' /></colgroup><colgroup id='TBL-5-3g'><col id='TBL-5-3' /></colgroup><colgroup id='TBL-5-4g'><col id='TBL-5-4' /></colgroup><colgroup id='TBL-5-5g'><col id='TBL-5-5' /></colgroup><colgroup id='TBL-5-6g'><col id='TBL-5-6' /></colgroup><colgroup id='TBL-5-7g'><col id='TBL-5-7' /></colgroup><colgroup id='TBL-5-8g'><col id='TBL-5-8' /></colgroup><colgroup id='TBL-5-9g'><col id='TBL-5-9' /></colgroup><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-1-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-1-1'> <div class='multirow'><!--  rows=6  -->
<span class='cmbx-12'>Classifier</span></div>          </td><td colspan='3' style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-1-2'></td>            <div class='multicolumn' style='white-space:nowrap; text-align:center;'><span class='cmbx-12'>Restricted API (959)</span></div>              <td colspan='3' style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-1-6'></td>                 <div class='multicolumn' style='white-space:nowrap; text-align:center;'><span class='cmbx-12'>2-Opc (30)</span></div>
</tr><tr class='cline'><td></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-3-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-3-1'>                  </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-2'> <span class='cmbx-12'>Pre (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-3'> <span class='cmbx-12'>Rec (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-4'> <span class='cmbx-12'>F1 (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-5'> <span class='cmbx-12'>FPR (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-6'> <span class='cmbx-12'>Pre (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-7'> <span class='cmbx-12'>Rec (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-8'> <span class='cmbx-12'>F1 (%) </span></td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-3-9'> <span class='cmbx-12'>FPR (%) </span></td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-4-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-4-1'> <div class='multirow'><!--  rows=6  -->
Random Forest</div>       </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-2'>   85.36    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-3'>   88.76    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-4'>  84.64   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-5'>   18.48     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-6'>   96.21    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-7'>   94.25    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-8'>  96.20   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-4-9'>    2.4       </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-5-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-5-1'> <div class='multirow'><!--  rows=6  -->
Extra Tree</div>            </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-2'>   85.38    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-3'>   88.62    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-4'>  84.69   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-5'>   18.29     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-6'>   96.06    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-7'>   94.05    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-8'>  96.05   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-5-9'>    2.51      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-6-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-6-1'> <div class='multirow'><!--  rows=6  -->
Decision Tree</div>         </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-2'>   84.82    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-3'>   88.43    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-4'>  84.02   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-5'>   19.32     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-6'>   93.28    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-7'>   93.00    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-8'>  93.25   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-6-9'>    6.59      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-7-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-7-1'> <div class='multirow'><!--  rows=6  -->
Logistic Regression</div>  </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-2'>   81.15    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-3'>   84.30    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-4'>  80.29   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-5'>   22.82     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-6'>   73.89    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-7'>   55.85    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-8'>  72.92   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-7-9'>   13.49     </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-8-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-8-1'> <div class='multirow'><!--  rows=6  -->
Neural Network</div>      </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-2'>   81.70    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-3'>   83.28    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-4'>  81.18   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-5'>   20.51     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-6'>   87.82    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-7'>   85.04    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-8'>  87.84   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-8-9'>   10.13     </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr id='TBL-5-9-' style='vertical-align:baseline;'><td style='white-space:nowrap; text-align:left;' class='td11' id='TBL-5-9-1'> <div class='multirow'><!--  rows=6  -->
Nearest Neighbour</div>  </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-2'>   83.14    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-3'>   98.06    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-4'>  74.56   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-5'>   41.55     </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-6'>   91.08    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-7'>   90.90    </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-8'>  91.03   </td><td style='white-space:nowrap; text-align:center;' class='td11' id='TBL-5-9-9'>    8.91      </td>
</tr><tr class='hline'><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr></table></div>


   </figure>
   </div>
   <h4 class='subsectionHead'><span class='titlemark'>3.4   </span> <a id='x1-70003.4'></a>Run-time Efficiency</h4>
<!-- l. 248 --><p class='noindent'>The execution time of an App with different technqiues on Xiaomi 10T and Redmi Note 7Pro is
shown in Figure <a href='#x1-70032'>2<!-- tex4ht:ref: fig:runTimeEfi  --></a>. </p><figure class='figure'>



<a id='x1-70032'></a>


<a id='x1-7001r1'></a>
<div class='subfigure'><table><tr><td style='text-align:left'> <img width='600px' alt='PIC' src='images/execute-2-xiaomi-.png' />
<div class='subfigcaption'><span class='cmr-10'>(a)
</span><span class='cmr-10'>Execution
</span><span class='cmr-10'>time
</span><span class='cmr-10'>on
</span><span class='cmr-10'>Xiaomi
</span><span class='cmr-10'>10T. </span></div></td></tr></table></div>
<a id='x1-7002r2'></a><div class='subfigure'><table><tr><td style='text-align:left'> <img width='600px'  alt='PIC' src='images/execute-2-redmi-.png' />
<div class='subfigcaption'><span class='cmr-10'>(b)
</span><span class='cmr-10'>Execution
</span><span class='cmr-10'>time
</span><span class='cmr-10'>on
</span><span class='cmr-10'>Redmi
</span><span class='cmr-10'>Note
</span><span class='cmr-10'>7Pro.</span>
</div>     </td></tr></table></div>
<figcaption class='caption'><span class='id'>Figure 2:</span><span class='content'>Execution time of an App with different techniques (i) 1-Gram, (ii) 2-Gram, (iii)
3-Gram, (iv) Used Permissions (UP), (v) Suspicious APIs (SA), (vi) Restricted APIs, and (vii)
USR (Combined UP, SA and RA).</span></figcaption><!-- tex4ht:label?: x1-70032  -->


   </figure>
   <h4 class='subsectionHead'><span class='titlemark'>3.5   </span> <a id='x1-80003.5'></a>Feature Importance</h4>
<!-- l. 258 --><p class='noindent'>In this experiment, we show the quality of our features concerning classes, i.e., malware and benign.
For the experiment, we train a random forest model on our training set for both categories of features
individually, i.e., selected requested permissions and 2-Gram opcode sequence. The importance of
both the feature set is shown in Figure <a href='#x1-80033'>3<!-- tex4ht:ref: fig:FeatImp  --></a>. Figure <a href='#x1-8001r1'>3(a)<!-- tex4ht:ref: fig:featImpRP  --></a> shows the top 30 requested permission’s feature
importance while the feature importance of the 2-Gram opcode sequence is projected in Figure
<a href='#x1-8002r2'>3(b)<!-- tex4ht:ref: fig:featImpOPC  --></a>.
</p><!-- l. 260 --><p class='indent'>   In Figure <a href='#x1-8001r1'>3(a)<!-- tex4ht:ref: fig:featImpRP  --></a>, we observe a large difference in the feature importance of GE_ACCOUNT
permission between malware and benign, which indicates how well this feature can distinguish
malware from benign App. Similarly, when we observe the feature importance of the 2-Gram opcode
sequence, then a Bit-wise instruction followed by a branch instruction (SB feature in Figure <a href='#x1-8002r2'>3(b)<!-- tex4ht:ref: fig:featImpOPC  --></a>) is
more important for the identification of malware and benign. We observes such difference in all the
features for both the feature set, which shows the quality of features in distinguishing malware from
benign.
</p>
   <figure class='figure'>



<a id='x1-80033'></a>


<a id='x1-8001r1'></a>
<div class='subfigure'><table><tr><td style='text-align:left'> <img width='600px' alt='PIC' src='images/FeatureImpReqPerm-.png' />
<div class='subfigcaption'><span class='cmr-10'>(a)
</span><span class='cmr-10'>Requested
</span><span class='cmr-10'>Permissions
</span><span class='cmr-10'>(top
</span><span class='cmr-10'>30). </span></div> </td></tr></table></div>
<a id='x1-8002r2'></a><div class='subfigure'><table><tr><td style='text-align:left'> <img width='380px' alt='PIC' src='images/FeatureImpOPC-.png' />
<div class='subfigcaption'><span class='cmr-10'>(b)
</span><span class='cmr-10'>2-Gram
</span><span class='cmr-10'>Opcode
</span><span class='cmr-10'>sequence.</span>
</div>       </td></tr></table></div>
<figcaption class='caption'><span class='id'>Figure 3:</span><span class='content'>Importance of features for malware detection. Figure <a href='#x1-8001r1'>3(a)<!-- tex4ht:ref: fig:featImpRP  --></a> shows importance of top
30 requested permissions while Figure <a href='#x1-8002r2'>3(b)<!-- tex4ht:ref: fig:featImpOPC  --></a> shows importance of 2-Gram opcode sequence.</span></figcaption><!-- tex4ht:label?: x1-80033  -->


   </figure>
<!-- l. 273 --><p class='indent'>   We have also conducted a similar experiment with new samples (AndroZoo-2019) and
obfuscated malware samples by including benign samples from AndroZoo-2019. The feature
importance result for new and obfuscated samples are shown in Figure <a href='#x1-80064'>4<!-- tex4ht:ref: fig:FeatImp-2019  --></a> and Figure <a href='#x1-80095'>5<!-- tex4ht:ref: fig:FeatImp-OBFS  --></a>,
respectively.


</p><!-- l. 275 --><p class='indent'>   <a id='x1-80064'></a></p><figure class='float'>


<a id='x1-8004r1'></a>
<div class='subfigure'><table><tr><td style='text-align:left'> <img width='600px' ='PIC' src='images/FeatureImpReqPerm-2019-.png' />
<div class='subfigcaption'><span class='cmr-10'>(a)
</span><span class='cmr-10'>Requested
</span><span class='cmr-10'>Permissions
</span><span class='cmr-10'>(top
</span><span class='cmr-10'>30). </span></div> </td></tr></table></div>
<a id='x1-8005r2'></a><div class='subfigure'><table><tr><td style='text-align:left'> <img width='380px' alt='PIC' src='images/FeatureImpOPC_2019-.png' />
<div class='subfigcaption'><span class='cmr-10'>(b)
</span><span class='cmr-10'>2-Gram
</span><span class='cmr-10'>Opcode
</span><span class='cmr-10'>sequence.</span>
</div>       </td></tr></table></div>
<figcaption class='caption'><span class='id'>Figure 4:</span><span class='content'>Importance  of  features  for  malware  detection  with  new  sample  (AndroZoo-2019).
Figure  <a href='#x1-8004r1'>4(a)<!-- tex4ht:ref: fig:featImpRP-2019  --></a>  shows  importance  of  top  30  requested  permissions  while  Figure  <a href='#x1-8005r2'>4(b)<!-- tex4ht:ref: fig:featImpOPC-2019  --></a>  shows
importance of 2-Gram opcode sequence.</span></figcaption><!-- tex4ht:label?: x1-80064  -->


   </figure>


<!-- l. 286 --><p class='indent'>   <a id='x1-80095'></a></p><figure class='float'>


<a id='x1-8007r1'></a>
<div class='subfigure'><table><tr><td style='text-align:left'> <img width='600px' alt='PIC' src='images/FeatureImpReqPerm_OBFS-.png' />
<div class='subfigcaption'><span class='cmr-10'>(a)
</span><span class='cmr-10'>Requested
</span><span class='cmr-10'>Permissions
</span><span class='cmr-10'>(top
</span><span class='cmr-10'>30). </span></div> </td></tr></table></div>
<a id='x1-8008r2'></a><div class='subfigure'><table><tr><td style='text-align:left'> <img width='410px' alt='PIC' src='images/FeatureImpOPC_OBFS-.png' />
<div class='subfigcaption'><span class='cmr-10'>(b)
</span><span class='cmr-10'>2-Gram
</span><span class='cmr-10'>Opcode
</span><span class='cmr-10'>sequence.</span>
</div>       </td></tr></table></div>
<figcaption class='caption'><span class='id'>Figure 5:</span><span class='content'>Importance of features for malware detection with obfuscated samples. Figure <a href='#x1-8007r1'>5(a)<!-- tex4ht:ref: fig:featImpRP-OBFS  --></a>
shows  importance  of  top  30  requested  permissions  while  Figure  <a href='#x1-8008r2'>5(b)<!-- tex4ht:ref: fig:featImpOPC-OBFS  --></a>  shows  importance  of
2-Gram opcode sequence.</span></figcaption><!-- tex4ht:label?: x1-80095  -->


   </figure>


   <h3 class='likesectionHead'><a id='x1-90003.5'></a>References</h3>
<!-- l. 296 --><p class='noindent'>
   </p><div class='thebibliography'>
   <p class='bibitem'><span class='biblabel'>
 [1]<span class='bibsp'>   </span></span><a id='XArp14drebin:effective'></a>D. Arp, M. Spreitzenbarth, M. and Hübnerr, H. Gascon, and K. Riec, “Drebin: Effective
   and explainable detection of android malware in your pocket,” in <span class='cmti-12'>Symposium on Network
   </span><span class='cmti-12'>and Distributed System Security(NDSS)</span>, 02 2014.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [2]<span class='bibsp'>   </span></span><a id='XintelliAV'></a>M.  Ahmadi,  A.  Sotgiu,  and  G.  Giacinto,  "IntelliAV:  Toward  the  feasibility  of
   building intelligent anti-malware on Android devices," in <span class='cmti-12'>Machine Learning and Knowledge
   </span><span class='cmti-12'>Extraction</span>,  A.  Holzinger,  P.  Kieseberg,  A.  M.Tjoa,  and  E.  Weippl,  Eds.  Springer
   International Publishing, 2017, pp.137--154.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [3]<span class='bibsp'>   </span></span><a id='X10.1145/3029806.3029825'></a>G. Suarez-Tangil, S. K. Dash, M. Ahmadi, J. Kinder, G. Giacinto, andL. Cavallaro,
   "DroidSieve:  Fast  and  accurate  classification  of  obfuscated  Android  malware,"  in
   <span class='cmti-12'>Proceedings of the Seventh ACM on Conference on Data and Application Security and
   </span><span class='cmti-12'>Privacy</span>, 2017, p. 309--320.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [4]<span class='bibsp'>   </span></span><a id='X10.1145/3162625'></a>J. Garcia, M. Hammad, and S. Malek, "Lightweight, obfuscation-resilient detection and
   family identification of android malware," ACM Trans. Softw. Eng. Methodol., vol. 26, no.
   3, Jan. 2018.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [5]<span class='bibsp'>   </span></span><a id='Xwei2017deep'></a>F. Wei, Y. Li, S. Roy, X. Ou, and W. Zhou, "Deep ground truth analysisof current
   android malware," in Detection of Intrusions and Malware,and Vulnerability Assessment.
   Springer International Publishing, 2017,pp. 252--276.
   </p>
   <p class='bibitem'><span class='biblabel'>
 [6]<span class='bibsp'>   </span></span><a id='XVirusShare:2018'></a>VirusShare. (2018). [Online]. Available: <a class='url' href='https://virusshare.com/'><span class='cmtt-12'>https://virusshare.com/</span></a>
   </p>
   <p class='bibitem'><span class='biblabel'>
 [7]<span class='bibsp'>   </span></span><a id='XVirusTotal:2019'></a>VirusTotal. (2018). [Online]. Available: <a class='url' href='https://www.virustotal.com/'><span class='cmtt-12'>https://www.virustotal.com/</span></a>
</p>
   </div>
</div>
</body>
</html>
