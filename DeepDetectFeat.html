<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html >
<head><title>Additional Information of DeepDetect</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)">
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)">
<!-- html -->
<meta name="src" content="DeepDetectFeat.tex">
<link rel="stylesheet" type="text/css" href="DeepDetectFeat.css">
</head><body
>
   <div class="maketitle">





<h2 class="titleHead">Additional Information of DeepDetect</h2>
<div class="author" ></div><br />
<div class="date" ><span
class="cmr-12x-x-120">September 2, 2021</span></div>
   </div>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a
 id="x1-10001"></a>Features Used in DeepDetect</h3>
<!--l. 30--><p class="noindent" >The feature used in DeepDetect are as follows:
<!--l. 33--><p class="noindent" ><span
class="cmbxti-10x-x-120">(i) </span><span
class="cmbx-12">Numeric Features: </span>List of numeric feature used are as follows:


   <div class="verbatim" id="verbatim-1">
Activities
&#x00A0;<br />Services
&#x00A0;<br />Brodcast&#x00A0;Receivers
&#x00A0;<br />Content&#x00A0;Providers
&#x00A0;<br />Custom&#x00A0;Permissions.
</div>
<!--l. 41--><p class="nopar" >
<!--l. 43--><p class="noindent" ><span
class="cmbxti-10x-x-120">(ii) </span><span
class="cmbx-12">Requested Permissions: </span>The list of requested permission used are as follows:


   <div class="verbatim" id="verbatim-2">
android.permission.RECEIVE_BOOT_COMPLETED
&#x00A0;<br />android.permission.ACCESS_NETWORK_STATE
&#x00A0;<br />android.permission.RECEIVE_SMS
&#x00A0;<br />android.permission.VIBRATE
&#x00A0;<br />android.permission.ACCESS_COARSE_LOCATION
&#x00A0;<br />android.permission.INSTALL_PACKAGES
&#x00A0;<br />android.permission.READ_SMS
&#x00A0;<br />android.permission.PROCESS_OUTGOING_CALLS
&#x00A0;<br />android.permission.READ_PHONE_STATE
&#x00A0;<br />android.permission.WRITE_EXTERNAL_STORAGE
&#x00A0;<br />android.permission.WAKE_LOCK
&#x00A0;<br />android.permission.SEND_SMS
&#x00A0;<br />android.permission.INTERNET
&#x00A0;<br />android.permission.GET_ACCOUNTS
&#x00A0;<br />android.permission.DISABLE_KEYGUARD
&#x00A0;<br />android.permission.CHANGE_WIFI_STATE
&#x00A0;<br />android.permission.ACCESS_WIFI_STATE
&#x00A0;<br />android.permission.READ_LOGS
&#x00A0;<br />android.permission.CALL_PHONE
&#x00A0;<br />android.permission.READ_CONTACTS
&#x00A0;<br />android.permission.GET_TASKS
&#x00A0;<br />android.permission.WRITE_SMS
&#x00A0;<br />android.permission.SET_WALLPAPER
&#x00A0;<br />android.permission.ACCESS_GPS
&#x00A0;<br />android.permission.WRITE_SETTINGS
&#x00A0;<br />android.permission.READ_EXTERNAL_STORAGE
&#x00A0;<br />android.permission.SYSTEM_ALERT_WINDOW
&#x00A0;<br />android.permission.RESTART_PACKAGES
&#x00A0;<br />android.permission.MOUNT_UNMOUNT_FILESYSTEMS
&#x00A0;<br />android.permission.CHANGE_NETWORK_STATE
&#x00A0;<br />android.permission.WRITE_CONTACTS
&#x00A0;<br />android.permission.CAMERA
&#x00A0;<br />android.permission.KILL_BACKGROUND_PROCESSES
&#x00A0;<br />android.permission.ACCESS_LOCATION_EXTRA_COMMANDS
&#x00A0;<br />android.permission.BLUETOOTH_ADMIN
&#x00A0;<br />android.permission.USE_CREDENTIALS
&#x00A0;<br />android.permission.RECORD_AUDIO
&#x00A0;<br />android.permission.MODIFY_AUDIO_SETTINGS
&#x00A0;<br />android.permission.BROADCAST_STICKY
&#x00A0;<br />android.permission.CHANGE_CONFIGURATION
</div>
<!--l. 86--><p class="nopar" >
<!--l. 88--><p class="noindent" ><span
class="cmbxti-10x-x-120">(iii) </span><span
class="cmbx-12">2-Gram Opcode Sequence: </span>The 2-Gram opcode sequence used in DeepDetect
are shown bellow. To know about the Reduce instruction set symbols, plese see Table
<a
href="#x1-10011">1<!--tex4ht:ref: tab:redIns --></a>.


   <div class="verbatim" id="verbatim-3">
DX,XR,VD,PG,IL,
&#x00A0;<br />LL,SC,SR,BV,TM,
&#x00A0;<br />AA,FM,OM,TR,XP,
&#x00A0;<br />GM,XI,PA,AT,OL,
&#x00A0;<br />DM,DP,FP,SX,OP,
&#x00A0;<br />FT,LV,MM,TP,SB
</div>
<!--l. 97--><p class="nopar" >
   <div class="table">


<!--l. 99--><p class="indent" >   <a
 id="x1-10011"></a><hr class="float"><div class="float"
>


 <div class="caption"
><span class="id">Table&#x00A0;1: </span><span
class="content">Reduced instruction set with description.</span></div><!--tex4ht:label?: x1-10011 -->
<div class="tabular"> <table id="TBL-2" class="tabular"
cellspacing="0" cellpadding="0"
><colgroup id="TBL-2-1g"><col
id="TBL-2-1"></colgroup><colgroup id="TBL-2-2g"><col
id="TBL-2-2"></colgroup><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-1-1"
class="td11"><span
class="cmbx-10">Symbol</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"
class="td11"><span
class="cmbx-10">Description                                                   </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-2-1"
class="td11">   <span
class="cmr-10">A     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"
class="td11"><span
class="cmr-10">Arithmetic operation instructions                               </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-3-1"
class="td11">   <span
class="cmr-10">B     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"
class="td11"><span
class="cmr-10">Branch instruction (Conditional jump like if-eq).           </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-4-1"
class="td11">   <span
class="cmr-10">C     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"
class="td11"><span
class="cmr-10">Comparision instruction like cmpl-float                        </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-5-1"
class="td11">   <span
class="cmr-10">D     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-2"
class="td11"><span
class="cmr-10">Data Definition instructions like const/4                      </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-6-1"
class="td11">   <div class="multirow"><!-- rows=0 -->
<span
class="cmr-10">F</span></div>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-2"
class="td11"><span
class="cmr-10">Type conversion instructions (int-to-long, int-to-float)     </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-7-1"
class="td11">   <span
class="cmr-10">G     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-2"
class="td11"><span
class="cmr-10">Get instructions (aget, aget-wide)                               </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-8-1"
class="td11">    <div class="multirow"><!-- rows=0 -->
<span
class="cmr-10">I</span></div>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-2"
class="td11"><span
class="cmr-10">Method call instructions (invoke-direct, invoke-virtual ...)</span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-9-1"
class="td11">   <span
class="cmr-10">J     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-2"
class="td11"><span
class="cmr-10">Jump instructions (Unconditional) like goto.                 </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-10-1"
class="td11">   <div class="multirow"><!-- rows=0 -->
<span
class="cmr-10">L</span></div>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-2"
class="td11"><span
class="cmr-10">Lock instruction, the use to acquire/release a lock          </span></td>
</tr><tr
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-11-1"
class="td11">        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-2"
class="td11"><span
class="cmr-10">(monitor-enter and monitor-exit)                                </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-12-1"
class="td11">   <div class="multirow"><!-- rows=0 -->
<span
class="cmr-10">M</span></div>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-2"
class="td11"><span
class="cmr-10">Data manipulation instruction like move and its variants </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-13-1"
class="td11">   <span
class="cmr-10">O     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-2"
class="td11"><span
class="cmr-10">Exception instruction (through)                                 </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-14-1"
class="td11">   <span
class="cmr-10">P     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-2"
class="td11"><span
class="cmr-10">Put instructions (aput, aput-wide)                              </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-15-1"
class="td11">   <span
class="cmr-10">R     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-2"
class="td11"><span
class="cmr-10">Return instruction like return-void                              </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-16-1"
class="td11">   <span
class="cmr-10">S     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-2"
class="td11"><span
class="cmr-10">Bit-wise operation instructions (and-int, shl-int)            </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-17-1"
class="td11">   <span
class="cmr-10">T     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-2"
class="td11"><span
class="cmr-10">Type judgement like check-cast                                  </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-18-1"
class="td11">   <span
class="cmr-10">V     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-18-2"
class="td11"><span
class="cmr-10">Array operation instructions like array-length                </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-19-1"
class="td11">   <span
class="cmr-10">X     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-19-2"
class="td11"><span
class="cmr-10">switch case instructions                                            </span></td>
</tr><tr
class="hline"><td><hr></td><td><hr></td></tr><tr
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-20-1"
class="td11">        </td></tr></table></div>


   </div><hr class="endfloat" />
   </div>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a
 id="x1-20002"></a>Feature Importance</h3>
<!--l. 133--><p class="noindent" >In this experiment, we show the quality of our features concerning classes, i.e., malware and benign.
For the experiment, we train a random forest model on our training set for both categories of features
individually, i.e., selected requested permissions and 2-Gram opcode sequence. The importance of
both the feature set is shown in Figure <a
href="#x1-20031">1<!--tex4ht:ref: fig:FeatImp --></a>. Figure <a
href="#x1-2001r1">1(a)<!--tex4ht:ref: fig:featImpRP --></a> shows the top 30 requested permission&#8217;s feature
importance while the feature importance of the 2-Gram opcode sequence is projected in Figure
<a
href="#x1-2002r2">1(b)<!--tex4ht:ref: fig:featImpOPC --></a>.
<!--l. 135--><p class="indent" >   In Figure <a
href="#x1-2001r1">1(a)<!--tex4ht:ref: fig:featImpRP --></a>, we observe a large difference in the feature importance of GE_ACCOUNT
permission between malware and benign, which indicates how well this feature can distinguish
malware from benign App. Similarly, when we observe the feature importance of the 2-Gram opcode
sequence, then a Bit-wise instruction followed by a branch instruction (SB feature in Figure <a
href="#x1-2002r2">1(b)<!--tex4ht:ref: fig:featImpOPC --></a>) is
more important for the identification of malware and benign. We observes such difference in all the
features for both the feature set, which shows the quality of features in distinguishing malware from
benign.
<!--l. 137--><p class="indent" >   <hr class="figure"><div class="figure"
>


<a
 id="x1-20031"></a>


<a
 id="x1-2001r1"></a>
<div class="subfigure"><table><tr><td style="text-align:left"> <img
src="images/FeatureImpReqPerm.png" alt="PIC"
>
<div class="subfigcaption"><span
class="cmr-10">(a)</span>
<span
class="cmr-10">Requested</span>
<span
class="cmr-10">Permissions</span>
<span
class="cmr-10">(top</span>
<span
class="cmr-10">30). </span></div> </td></tr></table></div>                                                                                                                                  <a
 id="x1-2002r2"></a><div class="subfigure"><table><tr><td style="text-align:left"> <img
src="images/FeatureImpOPC.png" alt="PIC"
>
<div class="subfigcaption"><span
class="cmr-10">(b)</span>
<span
class="cmr-10">2-Gram</span>
<span
class="cmr-10">Opcode</span>
<span
class="cmr-10">sequence.</span>
</div>       </td></tr></table></div>
 <div class="caption"
><span class="id">Figure&#x00A0;1: </span><span
class="content">Importance of features for malware detection. Figure <a
href="#x1-2001r1">1(a)<!--tex4ht:ref: fig:featImpRP --></a> shows importance of top
30 requested permissions while Figure <a
href="#x1-2002r2">1(b)<!--tex4ht:ref: fig:featImpOPC --></a> shows importance of 2-Gram opcode sequence.</span></div><!--tex4ht:label?: x1-20031 -->


<!--l. 146--><p class="indent" >   </div><hr class="endfigure">
<!--l. 148--><p class="indent" >   We have also conducted a similar experiment with new samples (AndroZoo-2019) and
obfuscated malware samples by including benign samples from AndroZoo-2019. The feature
importance result for new and obfuscated samples are shown in Figure <a
href="#x1-20062">2<!--tex4ht:ref: fig:FeatImp-2019 --></a> and Figure <a
href="#x1-20093">3<!--tex4ht:ref: fig:FeatImp-OBFS --></a>,
respectively.


<!--l. 150--><p class="indent" >   <a
 id="x1-20062"></a><hr class="float"><div class="float"
>


<a
 id="x1-2004r1"></a>
<div class="subfigure"><table><tr><td style="text-align:left"> <img
src="images/FeatureImpReqPerm2019.png" alt="PIC"
>
<div class="subfigcaption"><span
class="cmr-10">(a)</span>
<span
class="cmr-10">Requested</span>
<span
class="cmr-10">Permissions</span>
<span
class="cmr-10">(top</span>
<span
class="cmr-10">30). </span></div> </td></tr></table></div>                                                                                                                                  <a
 id="x1-2005r2"></a><div class="subfigure"><table><tr><td style="text-align:left"> <img
src="images/FeatureImpOPC2019.png" alt="PIC"
>
<div class="subfigcaption"><span
class="cmr-10">(b)</span>
<span
class="cmr-10">2-Gram</span>
<span
class="cmr-10">Opcode</span>
<span
class="cmr-10">sequence.</span>
</div>       </td></tr></table></div>
 <div class="caption"
><span class="id">Figure&#x00A0;2: </span><span
class="content">Importance of features for malware detection with new sample (AndroZoo-2019).
Figure  <a
href="#x1-2004r1">2(a)<!--tex4ht:ref: fig:featImpRP-2019 --></a>  shows  importance  of  top  30  requested  permissions  while  Figure  <a
href="#x1-2005r2">2(b)<!--tex4ht:ref: fig:featImpOPC-2019 --></a>  shows
importance of 2-Gram opcode sequence.</span></div><!--tex4ht:label?: x1-20062 -->


   </div><hr class="endfloat" />


<!--l. 161--><p class="indent" >   <a
 id="x1-20093"></a><hr class="float"><div class="float"
>


<a
 id="x1-2007r1"></a>
<div class="subfigure"><table><tr><td style="text-align:left"> <img
src="images/FeatureImpReqPermOBFS.png" alt="PIC"
>
<div class="subfigcaption"><span
class="cmr-10">(a)</span>
<span
class="cmr-10">Requested</span>
<span
class="cmr-10">Permissions</span>
<span
class="cmr-10">(top</span>
<span
class="cmr-10">30). </span></div> </td></tr></table></div>                                                                                                                                  <a
 id="x1-2008r2"></a><div class="subfigure"><table><tr><td style="text-align:left"> <img
src="images/FeatureImpOPCOBFS.png" alt="PIC"  
>
<div class="subfigcaption"><span
class="cmr-10">(b)</span>
<span
class="cmr-10">2-Gram</span>
<span
class="cmr-10">Opcode</span>
<span
class="cmr-10">sequence.</span>
</div>       </td></tr></table></div>
 <div class="caption"
><span class="id">Figure&#x00A0;3: </span><span
class="content">Importance of features for malware detection with obfuscated samples. Figure <a
href="#x1-2007r1">3(a)<!--tex4ht:ref: fig:featImpRP-OBFS --></a>
shows  importance  of  top  30  requested  permissions  while  Figure  <a
href="#x1-2008r2">3(b)<!--tex4ht:ref: fig:featImpOPC-OBFS --></a>  shows  importance  of
2-Gram opcode sequence.</span></div><!--tex4ht:label?: x1-20093 -->


   </div><hr class="endfloat" />

</body></html>
